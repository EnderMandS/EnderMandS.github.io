---
layout: post
title: "Fast-LIVO2"
date: 2025-09-02 16:04:00 +0800
categories: [Paper, SLAM, Lidar, Visual]
---

# FAST-LIVO2: Fast, Direct LiDAR-Inertial-Visual Odometry

Code: [https://github.com/hku-mars/FAST-LIVO2](https://github.com/hku-mars/FAST-LIVO2)

Paper: [https://arxiv.org/abs/2408.14035](https://arxiv.org/abs/2408.14035)

# FAST-LIVO2 on Resource-Constrained Platforms: LiDAR-Inertial-Visual Odometry with Efficient Memory and Computation

Paper: [https://arxiv.org/abs/2501.13876](https://arxiv.org/abs/2501.13876)
 
## 总体框架变化

| 模块 | FAST‑LIVO (v1) | FAST‑LIVO2 | 改进意义 |
|------|---------------|------------|----------|
| **融合框架** | 误差状态迭代卡尔曼滤波（ESIKF），LiDAR 点到面残差 + 视觉光度残差 + IMU 先验，**批量更新** | 仍用 ESIKF，但改为**顺序更新（Sequential Update）**：先 LiDAR 再视觉 | 顺序更新减少一次性构造大雅可比矩阵的开销，视觉可按需跳过，节省计算 |
| **地图结构** | LiDAR 全局地图 + 视觉全局地图（视觉点附着在 LiDAR 点上，但管理上分离） | **统一 LiDAR‑视觉本地地图**（Unified Local Map），直接在同一数据结构中管理几何与光度信息 | 避免跨地图数据同步，减少冗余存储，提高查询效率 |
| **视觉更新策略** | 固定频率使用视觉帧（例如每帧或固定间隔） | **退化感知 + 自适应视觉帧选择**（LiDAR 退化时用更多视觉帧，正常时稀疏用） | 在 LiDAR 约束足够时减少视觉计算，退化时增强视觉约束，兼顾效率与鲁棒性 |
| **退化检测** | 无专门退化检测 | 基于 LiDAR 平面法向的奇异值分解（SVD）归一化最小奇异值 $\tilde{\sigma}_{\min}$ 检测退化 | 让系统能动态调整视觉参与度，应对长廊、平面等退化场景 |
| **地图滑动策略** | 大尺寸本地地图，低频滑动 | 小尺寸本地地图，高频滑动 + **长期视觉地图**（Long-term Visual Map）存储历史视觉点 | 减少本地地图内存占用，长期地图保证长时间回访时的视觉约束 |

### ESIKF 顺序更新
- v1：LiDAR 和视觉残差一次性堆叠更新，视觉模块每帧都运行。
- v2：先用 LiDAR 残差更新，再用视觉残差更新；视觉模块可按退化状态跳过。
- 好处：避免大规模矩阵运算、视觉计算量显著下降（在 Hilti 数据集上视觉部分耗时减少 80%+）

### LiDAR 退化检测

方法：
1. 从当前 LiDAR 扫描提取平面法向集合
2. 计算 $n_{\text{est}} n_{\text{est}}^\mathsf{T}$ 的 SVD
3. 归一化奇异值向量 $[\tilde{\sigma}_{\min}, \tilde{\sigma}_{\text{mid}}, \tilde{\sigma}_{\max}]$
4. 若 $\tilde{\sigma}_{\min}$ 连续多帧低于阈值（如 0.07），判定退化

用途：决定视觉帧选择策略、阈值可跨 LiDAR 型号通用

### 自适应视觉帧选择

规则：
- 退化时：用所有可用图像（最大化视觉约束）
- 正常时：按位姿变化阈值 $\tau$ 选取关键帧
- 阈值自适应缩放：$ \tau = \sqrt{3} \cdot \tilde{\sigma}_{\min} \cdot \tau_{\text{predefined}} $

效果：
- LiDAR 约束强 → 视觉帧稀疏，节省计算
- LiDAR 退化 → 视觉帧密集，防止漂移

### 地图结构优化
v1：全局 LiDAR 地图（ikd-tree）+ 全局视觉地图（体素哈希）

v2：
- 统一本地地图：三层八叉树存储平面特征，部分点附带三层 patch 金字塔
- 长期视觉地图：稀疏存储历史视觉点，低内存占用
- 滑动策略：
    - 本地地图边长小（如 200m），高频滑动
    - 超出范围的视觉点转移到长期地图
    - 长期地图边长大（如 800m），低频滑动

